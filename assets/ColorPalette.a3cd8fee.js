import{j as a,f as M,g as x,h as L,a as B,b as E,c as D,B as p,d as f,l as k,P as U,i as z,r as m,u as Y,S as O,p as W,s as J,I as X,e as $}from"./index.3d3bdbf6.js";function K(t){const{width:e,height:i,signCanvas:h,handleMouseDown:n,handleMouseMove:c,handleTouchStart:l,handleTouchMove:d,setDrawing:r}=t.signCanvasObj;return a("canvas",{ref:h,className:"signCanvas",width:e,height:i,onMouseDown:n,onMouseMove:c,onTouchStart:l,onTouchMove:d,onTouchEnd:()=>r(!1),onMouseUp:()=>r(!1),onMouseOut:()=>r(!1),children:"Your browser does not support th canvas element"})}function Q(t){const{showUseBottom:e,callback:i}=t,{toStep:h}=M(),{downloadImg:n}=x(),{showPrompt:c,setPromptObj:l,closePrompt:d}=L(),r=B(),S=E(g=>g.createSign.handSignArray);function A(g){l({type:U.NOINPUT,title:"\u8B66\u544A\u8A0A\u606F",message:"\u6B64\u64CD\u4F5C\u5C07\u6C38\u4E45\u522A\u9664\u6A94\u6848\uFF0C\u78BA\u5B9A\u57F7\u884C?",confirmCallback:()=>{r(z(g)),d()}}),c()}return a("ul",{className:"",children:S.length?S.map((g,C)=>a("li",{className:"",children:D("div",{className:"flex flex-col justify-center items-center mb-4 lg:flex-row",children:[a("div",{className:"border-2 w-[30%] min-w-[200px] mr-5",children:a("img",{src:g,alt:`\u6211\u7684\u7C3D\u540D${C}`})}),D("div",{className:"flex flex-col",children:[e?a(p,{btnObj:{type:f.SECONDARY,title:"\u4F7F\u7528",clickHandler:()=>{r(k(g)),h("/SignPage/Step3",3),i&&i()}}}):null,a(p,{btnObj:{type:f.SECONDARY,title:"\u4E0B\u8F09",clickHandler:()=>n(g)}}),a(p,{btnObj:{type:f.SECONDARY,title:"\u522A\u9664",clickHandler:()=>A(C)}})]})]})},g)):a("p",{children:"\u60A8\u5C1A\u672A\u65B0\u589E\u4EFB\u4F55\u7C3D\u540D"})})}function q(){function t(n){return[n.clientX,n.clientY]}function e(n){return[n.touches[0].clientX,n.touches[0].clientY]}function i(n,c){let[l,d]=t(c),r=n.getBoundingClientRect();return l-=r.left,d-=r.top,[l,d]}function h(n,c){let[l,d]=e(c),r=n.getBoundingClientRect();return l-=r.left,d-=r.top,[l,d]}return{getMousePos:t,getCanvasMousePos:i,getCanvasTouchPos:h}}function V(t){const e=t==null?void 0:t.getContext("2d"),[i,h]=m.exports.useState(!1),[n,c]=m.exports.useState("black"),[l,d]=m.exports.useState({width:500,height:200});m.exports.useEffect(()=>(window.addEventListener("resize",o=>{window.innerWidth<500?d({width:window.innerWidth,height:200}):d({width:500,height:200})}),()=>{window.removeEventListener("resize",()=>{})}),[]);const{getCanvasMousePos:r,getCanvasTouchPos:S}=q(),{converCanvasToImage:A,checkImageSize:g}=x(),{toStep:C}=M(),{showMsg:y}=Y(),w=B(),T=E(o=>o.createSign.handSignArray);function F(o){const u=o.getContext("2d");u==null||u.clearRect(0,0,o.width,o.height)}function P(o){h(!0);let[u,s]=r(t,o);!e||(e.beginPath(),e.moveTo(u,s),o.preventDefault())}function R(o){if(!i)return;let[u,s]=r(t,o);!e||(e.lineWidth=2,e.lineCap="round",e.lineJoin="round",e.strokeStyle=n,e.shadowBlur=1,e.lineTo(u,s),e.stroke())}function v(o){h(!0);let[u,s]=S(t,o);!e||(e.beginPath(),e.moveTo(u,s))}function j(o){if(!i)return;let[u,s]=S(t,o);!e||(e.lineWidth=2,e.lineCap="round",e.lineJoin="round",e.strokeStyle=n,e.shadowBlur=1,e.shadowColor="black",e.lineTo(u,s),e.stroke())}const I=o=>{const u=o.target.files?o.target.files[0]:null;if(!(u!=null&&u.type.includes("image"))){y({type:O.ERROR,title:"\u4E0A\u50B3\u6A94\u6848\u8A0A\u606F",message:"\u60A8\u4E0A\u50B3\u7684\u4E26\u975E\u5716\u6A94"});return}if(!g(u==null?void 0:u.size))return;const s=new Image;s.onload=()=>{!t||e.drawImage(s,0,0,s.width,s.height,0,0,t.width,t.height)},s.src=URL.createObjectURL(u),w(k(s.src))};function b(){return A(t)}function H(){if(T.length>4){y({type:O.ERROR,title:"\u7C3D\u540D\u8A0A\u606F",message:"\u7121\u6CD5\u5132\u5B58\uFF0C\u6700\u591A\u53EA\u80FD\u5B58\u53D6\u4E94\u5F35\u7C3D\u540D"});return}w(W(b())),y({type:O.SUCCESS,title:"\u7C3D\u540D\u8A0A\u606F",message:"\u6210\u529F\u5132\u5B58\uFF0C\u8ACB\u67E5\u770B\u60A8\u7684\u7C3D\u540D\u6A94\u5217\u8868"})}function N(){w(J(1)),w(k(b())),C("/SignPage/Step3",3)}return{signCanvas:t,ctx:e,canvasSize:l,setStrokeColor:c,setDrawing:h,clearCanvas:F,handleMouseMove:R,handleMouseDown:P,handleTouchStart:v,handleTouchMove:j,handleUploadImage:I,useSign:N,keepInHandSignArray:H,toImage:b}}function Z(t){const[e,i]=m.exports.useState(0),h=c=>{t.setColor(c.target.value)},n=(c,l)=>{i(l),t.setColor(c)};return D("section",{className:"w-full flex justify-around",children:[a(p,{btnObj:{type:f.COLOR,color:"black",clickHandler:()=>n("black",0),active:e===0}}),a(p,{btnObj:{type:f.COLOR,color:"yellow",clickHandler:()=>n("yellow",1),active:e===1}}),a(p,{btnObj:{type:f.COLOR,color:"blue",clickHandler:()=>n("blue",2),active:e===2}}),a(p,{btnObj:{type:f.COLOR,color:"red",clickHandler:()=>n("red",3),active:e===3}}),a(X,{inputObj:{type:$.COLOR,handleOnchange:h,handleClick:()=>i(4),active:e===4}})]})}export{Q as M,K as S,Z as T,V as u};
